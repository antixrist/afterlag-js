(function(){var t,s;s=function(){function t(){}return t.merge_options=function(t,s){var i,n;n={};for(i in t)n[i]=t[i];for(i in s)n[i]=s[i];return n},t}(),t=function(){function t(t){var s;null==t&&(t={}),this._set_options(t),this._callbacks=[],s=this,this.ready=!1,this.status="processing",this.options.max>0&&(this._timeout_process=setTimeout(function(){return s._finish("timeout")},this.options.max)),this._time_started=(new Date).getTime(),this._last_checked=this._time_started,this._success_iterations=0,this._preprocess=setTimeout(function(){return s._process=setInterval(function(){var t,i;return i=(new Date).getTime(),t=i-s._last_checked-s.options.frequency,s.options.min_delta<t&&t<s.options.max_delta?(s._success_iterations++,s._success_iterations>=s.options.iterations&&s._finish("success")):s._success_iterations=0,s._last_checked=i},s.options.frequency)},this.options.delay)}return t.defaults={delay:100,frequency:30,iterations:3,duration:null,scatter:5,min_delta:null,max_delta:null,max:null},t.prototype._set_options=function(t){return this.options=s.merge_options(this.constructor.defaults,t),null!=this.options.frequency&&(this.options.frequency=parseInt(this.options.frequency)),null!=this.options.iterations&&(this.options.iterations=parseInt(this.options.iterations)),null!=this.options.scatter&&(this.options.scatter=parseInt(this.options.scatter)),null!=this.options.min_delta&&(this.options.min_delta=parseInt(this.options.min_delta)),null!=this.options.max_delta&&(this.options.max_delta=parseInt(this.options.max_delta)),null!=this.options.max&&(this.options.max=parseInt(this.options.max)),null!=this.options.duration&&(this.options.duration=parseInt(this.options.duration),this.options.iterations=Math.ceil(this.options.duration/this.options.frequency)),null==this.options.min_delta&&(this.options.min_delta=-this.options.scatter),null==this.options.max_delta?this.options.max_delta=this.options.scatter:void 0},t.prototype.info=function(){var t,s;return null!=this.time_passed?s=this.time_passed:(t=(new Date).getTime(),s=t-this._time_started),{status:this.status,time_passed:s,ready:this.ready,options:this.options}},t.prototype._finish=function(t){var s,i,n,e,o,a;for(null!=this._preprocess&&clearTimeout(this._preprocess),null!=this._process&&clearInterval(this._process),null!=this._timeout_process&&clearTimeout(this._timeout_process),this.ready=!0,this.status=t,e=(new Date).getTime(),this.time_passed=e-this._time_started,o=this._callbacks,a=[],i=0,n=o.length;n>i;i++)s=o[i],a.push(s.fn.call(s.self,this.info()));return a},t.prototype["do"]=function(t,s){return null==s&&(s=null),null==s&&(s=t,t=this),this.ready?s.call(t,this.info()):this._callbacks.push({fn:s,self:t}),this},t}(),window.Afterlag=t}).call(this);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFmdGVybGFnLmNvZmZlZSIsImFmdGVybGFnLmpzIl0sIm5hbWVzIjpbIkFmdGVybGFnIiwiQWZ0ZXJsYWdIZWxwZXIiLCJtZXJnZV9vcHRpb25zIiwiZmlyc3Rfb2JqZWN0Iiwic2Vjb25kX29iamVjdCIsImtleSIsInJlc3VsdF9vYmplY3QiLCJvcHRpb25zIiwic2VsZiIsInRoaXMiLCJfc2V0X29wdGlvbnMiLCJfY2FsbGJhY2tzIiwicmVhZHkiLCJzdGF0dXMiLCJtYXgiLCJfdGltZW91dF9wcm9jZXNzIiwic2V0VGltZW91dCIsIl9maW5pc2giLCJfdGltZV9zdGFydGVkIiwiRGF0ZSIsImdldFRpbWUiLCJfbGFzdF9jaGVja2VkIiwiX3N1Y2Nlc3NfaXRlcmF0aW9ucyIsIl9wcmVwcm9jZXNzIiwiX3Byb2Nlc3MiLCJzZXRJbnRlcnZhbCIsImRlbHRhIiwibm93IiwiZnJlcXVlbmN5IiwibWluX2RlbHRhIiwibWF4X2RlbHRhIiwiaXRlcmF0aW9ucyIsImRlbGF5IiwiZGVmYXVsdHMiLCJkdXJhdGlvbiIsInNjYXR0ZXIiLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsInBhcnNlSW50IiwiTWF0aCIsImNlaWwiLCJpbmZvIiwidGltZV9wYXNzZWQiLCJjYWxsYmFjayIsImkiLCJsZW4iLCJyZWYiLCJyZXN1bHRzIiwiY2xlYXJUaW1lb3V0IiwiY2xlYXJJbnRlcnZhbCIsImxlbmd0aCIsInB1c2giLCJmbiIsImNhbGwiLCJ3aW5kb3ciXSwibWFwcGluZ3MiOiJDQUFBLFdBQUEsR0FBQUEsR0FBQUMsQ0FBTUEsR0FBQSxXQ0lGLFFBQVNBLE1BY1QsTURqQkZBLEdBQUNDLGNBQWUsU0FBQ0MsRUFBY0MsR0FDN0IsR0FBQUMsR0FBQUMsQ0FBQUEsS0FDQSxLQUFBRCxJQUFBRixHQUNFRyxFQUFjRCxHQUFPRixFQUFhRSxFQUNwQyxLQUFBQSxJQUFBRCxHQUNFRSxFQUFjRCxHQUFPRCxFQUFjQyxFQ1NuQyxPRFJGQyxJQ1dPTCxLRFRMRCxFQUFBLFdB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QThCLEdBQUFDLEVBQUFDLEVBQUFsQixFQUFBbUIsRUFBQUMsQ0N5REUsS0R6RDRCLE1BQUF0QyxLQUFBYyxhQUE5QnlCLGFBQWF2QyxLQUFDYyxhQUNjLE1BQUFkLEtBQUFlLFVBQTVCeUIsY0FBY3hDLEtBQUNlLFVBQ29CLE1BQUFmLEtBQUFNLGtCQUFuQ2lDLGFBQWF2QyxLQUFDTSxrQkFDZE4sS0FBQ0csT0FBUSxFQUNUSCxLQUFDSSxPQUFTQSxFQUNWYyxHQUFVLEdBQUFSLE9BQU9DLFVBQ2pCWCxLQUFDaUMsWUFBY2YsRUFBTWxCLEtBQUNTLGNBQ3RCNEIsRUFBQXJDLEtBQUFFLFdBQUFvQyxLQUFBSCxFQUFBLEVBQUFDLEVBQUFDLEVBQUFJLE9BQUFMLEVBQUFELEVBQUFBLElDbURJRCxFQUFXRyxFQUFJRixHRGxEakJHLEVBQUFJLEtBQUFSLEVBQVNTLEdBQUdDLEtBQUtWLEVBQVNuQyxLQUFNQyxLQUFDZ0MsUUNxRGpDLE9BQU9NLElEaklYL0MsRUFBQW9DLFVBOEVBLE1BQUksU0FBQzVCLEVBQU00QyxHQ3NFUCxNQWZVLE9BQU5BLElEdkRHQSxFQUFHLE1BQ0wsTUFBQUEsSUFDTEEsRUFBSzVDLEVBQ0xBLEVBQU9DLE1BQ05BLEtBQUNHLE1BQ0Z3QyxFQUFHQyxLQUFLN0MsRUFBTUMsS0FBQ2dDLFFBRWZoQyxLQUFDRSxXQUFXd0MsTUFDVkMsR0FBSUEsRUFDSjVDLEtBQU1BLElBQ1ZDLE1DK0RPVCxLRDdEWHNELE9BQU90RCxTQUFXQSxJQ21FZnFELEtBQUs1QyIsImZpbGUiOiJhZnRlcmxhZy5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEFmdGVybGFnSGVscGVyXG4gIEBtZXJnZV9vcHRpb25zOiAoZmlyc3Rfb2JqZWN0LCBzZWNvbmRfb2JqZWN0KSAtPlxuICAgIHJlc3VsdF9vYmplY3QgPSB7fVxuICAgIGZvciBrZXkgb2YgZmlyc3Rfb2JqZWN0XG4gICAgICByZXN1bHRfb2JqZWN0W2tleV0gPSBmaXJzdF9vYmplY3Rba2V5XVxuICAgIGZvciBrZXkgb2Ygc2Vjb25kX29iamVjdFxuICAgICAgcmVzdWx0X29iamVjdFtrZXldID0gc2Vjb25kX29iamVjdFtrZXldXG4gICAgcmVzdWx0X29iamVjdFxuXG5jbGFzcyBBZnRlcmxhZ1xuICBAZGVmYXVsdHM6XG4gICAgZGVsYXk6IDEwMFxuICAgIGZyZXF1ZW5jeTogMzBcbiAgICBpdGVyYXRpb25zOiAzXG4gICAgZHVyYXRpb246IG51bGxcbiAgICBzY2F0dGVyOiA1XG4gICAgbWluX2RlbHRhOiBudWxsXG4gICAgbWF4X2RlbHRhOiBudWxsICAgIFxuICAgIG1heDogbnVsbFxuXG4gIGNvbnN0cnVjdG9yOiAob3B0aW9ucz17fSkgLT5cbiAgICBAX3NldF9vcHRpb25zIG9wdGlvbnNcbiAgICBAX2NhbGxiYWNrcyA9IFtdXG4gICAgc2VsZiA9IEBcbiAgICBAcmVhZHkgPSBmYWxzZVxuICAgIEBzdGF0dXMgPSAncHJvY2Vzc2luZydcbiAgICBpZiBAb3B0aW9ucy5tYXggPiAwXG4gICAgICBAX3RpbWVvdXRfcHJvY2VzcyA9IHNldFRpbWVvdXQgLT5cbiAgICAgICAgc2VsZi5fZmluaXNoICd0aW1lb3V0J1xuICAgICAgLCBAb3B0aW9ucy5tYXhcbiAgICBAX3RpbWVfc3RhcnRlZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgQF9sYXN0X2NoZWNrZWQgPSBAX3RpbWVfc3RhcnRlZFxuICAgIEBfc3VjY2Vzc19pdGVyYXRpb25zID0gMFxuICAgIEBfcHJlcHJvY2VzcyA9IHNldFRpbWVvdXQgLT5cbiAgICAgIHNlbGYuX3Byb2Nlc3MgPSBzZXRJbnRlcnZhbCAtPlxuICAgICAgICBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgICAgICBkZWx0YSA9IG5vdyAtIHNlbGYuX2xhc3RfY2hlY2tlZCAtIHNlbGYub3B0aW9ucy5mcmVxdWVuY3lcbiAgICAgICAgaWYgc2VsZi5vcHRpb25zLm1pbl9kZWx0YSA8IGRlbHRhIDwgc2VsZi5vcHRpb25zLm1heF9kZWx0YVxuICAgICAgICAgIHNlbGYuX3N1Y2Nlc3NfaXRlcmF0aW9ucysrXG4gICAgICAgICAgaWYgc2VsZi5fc3VjY2Vzc19pdGVyYXRpb25zID49IHNlbGYub3B0aW9ucy5pdGVyYXRpb25zXG4gICAgICAgICAgICBzZWxmLl9maW5pc2ggJ3N1Y2Nlc3MnXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBzZWxmLl9zdWNjZXNzX2l0ZXJhdGlvbnMgPSAwXG4gICAgICAgIHNlbGYuX2xhc3RfY2hlY2tlZCA9IG5vd1xuICAgICAgLCBzZWxmLm9wdGlvbnMuZnJlcXVlbmN5XG4gICAgLCBAb3B0aW9ucy5kZWxheVxuXG4gIF9zZXRfb3B0aW9uczogKG9wdGlvbnMpIC0+XG4gICAgIyBNZXJnZSBvcHRpb25zIHdpdGggZGVmYXVsdHNcbiAgICBAb3B0aW9ucyA9IEFmdGVybGFnSGVscGVyLm1lcmdlX29wdGlvbnMoQGNvbnN0cnVjdG9yLmRlZmF1bHRzLCBvcHRpb25zKVxuXG4gICAgIyBOb3JtYWxpemUgb3B0aW9uc1xuICAgIEBvcHRpb25zLmZyZXF1ZW5jeSA9IHBhcnNlSW50KEBvcHRpb25zLmZyZXF1ZW5jeSkgaWYgQG9wdGlvbnMuZnJlcXVlbmN5P1xuICAgIEBvcHRpb25zLml0ZXJhdGlvbnMgPSBwYXJzZUludChAb3B0aW9ucy5pdGVyYXRpb25zKSBpZiBAb3B0aW9ucy5pdGVyYXRpb25zP1xuICAgIEBvcHRpb25zLnNjYXR0ZXIgPSBwYXJzZUludChAb3B0aW9ucy5zY2F0dGVyKSBpZiBAb3B0aW9ucy5zY2F0dGVyP1xuICAgIEBvcHRpb25zLm1pbl9kZWx0YSA9IHBhcnNlSW50KEBvcHRpb25zLm1pbl9kZWx0YSkgaWYgQG9wdGlvbnMubWluX2RlbHRhP1xuICAgIEBvcHRpb25zLm1heF9kZWx0YSA9IHBhcnNlSW50KEBvcHRpb25zLm1heF9kZWx0YSkgaWYgQG9wdGlvbnMubWF4X2RlbHRhP1xuICAgIEBvcHRpb25zLm1heCA9IHBhcnNlSW50KEBvcHRpb25zLm1heCkgaWYgQG9wdGlvbnMubWF4P1xuICAgIGlmIEBvcHRpb25zLmR1cmF0aW9uP1xuICAgICAgQG9wdGlvbnMuZHVyYXRpb24gPSBwYXJzZUludCBAb3B0aW9ucy5kdXJhdGlvblxuICAgICAgQG9wdGlvbnMuaXRlcmF0aW9ucyA9IE1hdGguY2VpbChAb3B0aW9ucy5kdXJhdGlvbiAvIEBvcHRpb25zLmZyZXF1ZW5jeSlcbiAgICBpZiBub3QgQG9wdGlvbnMubWluX2RlbHRhP1xuICAgICAgQG9wdGlvbnMubWluX2RlbHRhID0gLSBAb3B0aW9ucy5zY2F0dGVyXG4gICAgaWYgbm90IEBvcHRpb25zLm1heF9kZWx0YT9cbiAgICAgIEBvcHRpb25zLm1heF9kZWx0YSA9IEBvcHRpb25zLnNjYXR0ZXJcblxuICBpbmZvOiAtPlxuICAgIGlmIEB0aW1lX3Bhc3NlZD9cbiAgICAgIHRpbWVfcGFzc2VkID0gQHRpbWVfcGFzc2VkXG4gICAgZWxzZVxuICAgICAgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICAgIHRpbWVfcGFzc2VkID0gbm93IC0gQF90aW1lX3N0YXJ0ZWRcbiAgICBzdGF0dXM6IEBzdGF0dXNcbiAgICB0aW1lX3Bhc3NlZDogdGltZV9wYXNzZWRcbiAgICByZWFkeTogQHJlYWR5XG4gICAgb3B0aW9uczogQG9wdGlvbnNcblxuICBfZmluaXNoOiAoc3RhdHVzKSAtPlxuICAgIGNsZWFyVGltZW91dChAX3ByZXByb2Nlc3MpIGlmIEBfcHJlcHJvY2Vzcz9cbiAgICBjbGVhckludGVydmFsKEBfcHJvY2VzcykgaWYgQF9wcm9jZXNzP1xuICAgIGNsZWFyVGltZW91dChAX3RpbWVvdXRfcHJvY2VzcykgaWYgQF90aW1lb3V0X3Byb2Nlc3M/XG4gICAgQHJlYWR5ID0gdHJ1ZVxuICAgIEBzdGF0dXMgPSBzdGF0dXNcbiAgICBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgIEB0aW1lX3Bhc3NlZCA9IG5vdyAtIEBfdGltZV9zdGFydGVkXG4gICAgZm9yIGNhbGxiYWNrIGluIEBfY2FsbGJhY2tzXG4gICAgICBjYWxsYmFjay5mbi5jYWxsKGNhbGxiYWNrLnNlbGYsIEBpbmZvKCkpXG5cbiAgZG86IChzZWxmLCBmbj1udWxsKSAtPlxuICAgIGlmIG5vdCBmbj9cbiAgICAgIGZuID0gc2VsZlxuICAgICAgc2VsZiA9IEBcbiAgICBpZiBAcmVhZHlcbiAgICAgIGZuLmNhbGwoc2VsZiwgQGluZm8oKSlcbiAgICBlbHNlXG4gICAgICBAX2NhbGxiYWNrcy5wdXNoXG4gICAgICAgIGZuOiBmblxuICAgICAgICBzZWxmOiBzZWxmXG4gICAgQFxuXG53aW5kb3cuQWZ0ZXJsYWcgPSBBZnRlcmxhZyIsIihmdW5jdGlvbigpIHtcbiAgdmFyIEFmdGVybGFnLCBBZnRlcmxhZ0hlbHBlcjtcblxuICBBZnRlcmxhZ0hlbHBlciA9IChmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBBZnRlcmxhZ0hlbHBlcigpIHt9XG5cbiAgICBBZnRlcmxhZ0hlbHBlci5tZXJnZV9vcHRpb25zID0gZnVuY3Rpb24oZmlyc3Rfb2JqZWN0LCBzZWNvbmRfb2JqZWN0KSB7XG4gICAgICB2YXIga2V5LCByZXN1bHRfb2JqZWN0O1xuICAgICAgcmVzdWx0X29iamVjdCA9IHt9O1xuICAgICAgZm9yIChrZXkgaW4gZmlyc3Rfb2JqZWN0KSB7XG4gICAgICAgIHJlc3VsdF9vYmplY3Rba2V5XSA9IGZpcnN0X29iamVjdFtrZXldO1xuICAgICAgfVxuICAgICAgZm9yIChrZXkgaW4gc2Vjb25kX29iamVjdCkge1xuICAgICAgICByZXN1bHRfb2JqZWN0W2tleV0gPSBzZWNvbmRfb2JqZWN0W2tleV07XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0X29iamVjdDtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEFmdGVybGFnSGVscGVyO1xuXG4gIH0pKCk7XG5cbiAgQWZ0ZXJsYWcgPSAoZnVuY3Rpb24oKSB7XG4gICAgQWZ0ZXJsYWcuZGVmYXVsdHMgPSB7XG4gICAgICBkZWxheTogMTAwLFxuICAgICAgZnJlcXVlbmN5OiAzMCxcbiAgICAgIGl0ZXJhdGlvbnM6IDMsXG4gICAgICBkdXJhdGlvbjogbnVsbCxcbiAgICAgIHNjYXR0ZXI6IDUsXG4gICAgICBtaW5fZGVsdGE6IG51bGwsXG4gICAgICBtYXhfZGVsdGE6IG51bGwsXG4gICAgICBtYXg6IG51bGxcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gQWZ0ZXJsYWcob3B0aW9ucykge1xuICAgICAgdmFyIHNlbGY7XG4gICAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XG4gICAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NldF9vcHRpb25zKG9wdGlvbnMpO1xuICAgICAgdGhpcy5fY2FsbGJhY2tzID0gW107XG4gICAgICBzZWxmID0gdGhpcztcbiAgICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICAgIHRoaXMuc3RhdHVzID0gJ3Byb2Nlc3NpbmcnO1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5tYXggPiAwKSB7XG4gICAgICAgIHRoaXMuX3RpbWVvdXRfcHJvY2VzcyA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHNlbGYuX2ZpbmlzaCgndGltZW91dCcpO1xuICAgICAgICB9LCB0aGlzLm9wdGlvbnMubWF4KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3RpbWVfc3RhcnRlZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgdGhpcy5fbGFzdF9jaGVja2VkID0gdGhpcy5fdGltZV9zdGFydGVkO1xuICAgICAgdGhpcy5fc3VjY2Vzc19pdGVyYXRpb25zID0gMDtcbiAgICAgIHRoaXMuX3ByZXByb2Nlc3MgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5fcHJvY2VzcyA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBkZWx0YSwgbm93O1xuICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICAgIGRlbHRhID0gbm93IC0gc2VsZi5fbGFzdF9jaGVja2VkIC0gc2VsZi5vcHRpb25zLmZyZXF1ZW5jeTtcbiAgICAgICAgICBpZiAoKHNlbGYub3B0aW9ucy5taW5fZGVsdGEgPCBkZWx0YSAmJiBkZWx0YSA8IHNlbGYub3B0aW9ucy5tYXhfZGVsdGEpKSB7XG4gICAgICAgICAgICBzZWxmLl9zdWNjZXNzX2l0ZXJhdGlvbnMrKztcbiAgICAgICAgICAgIGlmIChzZWxmLl9zdWNjZXNzX2l0ZXJhdGlvbnMgPj0gc2VsZi5vcHRpb25zLml0ZXJhdGlvbnMpIHtcbiAgICAgICAgICAgICAgc2VsZi5fZmluaXNoKCdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuX3N1Y2Nlc3NfaXRlcmF0aW9ucyA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBzZWxmLl9sYXN0X2NoZWNrZWQgPSBub3c7XG4gICAgICAgIH0sIHNlbGYub3B0aW9ucy5mcmVxdWVuY3kpO1xuICAgICAgfSwgdGhpcy5vcHRpb25zLmRlbGF5KTtcbiAgICB9XG5cbiAgICBBZnRlcmxhZy5wcm90b3R5cGUuX3NldF9vcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgdGhpcy5vcHRpb25zID0gQWZ0ZXJsYWdIZWxwZXIubWVyZ2Vfb3B0aW9ucyh0aGlzLmNvbnN0cnVjdG9yLmRlZmF1bHRzLCBvcHRpb25zKTtcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZnJlcXVlbmN5ICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmZyZXF1ZW5jeSA9IHBhcnNlSW50KHRoaXMub3B0aW9ucy5mcmVxdWVuY3kpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5pdGVyYXRpb25zICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLml0ZXJhdGlvbnMgPSBwYXJzZUludCh0aGlzLm9wdGlvbnMuaXRlcmF0aW9ucyk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vcHRpb25zLnNjYXR0ZXIgIT0gbnVsbCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuc2NhdHRlciA9IHBhcnNlSW50KHRoaXMub3B0aW9ucy5zY2F0dGVyKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubWluX2RlbHRhICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLm1pbl9kZWx0YSA9IHBhcnNlSW50KHRoaXMub3B0aW9ucy5taW5fZGVsdGEpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5tYXhfZGVsdGEgIT0gbnVsbCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMubWF4X2RlbHRhID0gcGFyc2VJbnQodGhpcy5vcHRpb25zLm1heF9kZWx0YSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vcHRpb25zLm1heCAhPSBudWxsKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5tYXggPSBwYXJzZUludCh0aGlzLm9wdGlvbnMubWF4KTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZHVyYXRpb24gIT0gbnVsbCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuZHVyYXRpb24gPSBwYXJzZUludCh0aGlzLm9wdGlvbnMuZHVyYXRpb24pO1xuICAgICAgICB0aGlzLm9wdGlvbnMuaXRlcmF0aW9ucyA9IE1hdGguY2VpbCh0aGlzLm9wdGlvbnMuZHVyYXRpb24gLyB0aGlzLm9wdGlvbnMuZnJlcXVlbmN5KTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubWluX2RlbHRhID09IG51bGwpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLm1pbl9kZWx0YSA9IC10aGlzLm9wdGlvbnMuc2NhdHRlcjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubWF4X2RlbHRhID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5tYXhfZGVsdGEgPSB0aGlzLm9wdGlvbnMuc2NhdHRlcjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgQWZ0ZXJsYWcucHJvdG90eXBlLmluZm8gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBub3csIHRpbWVfcGFzc2VkO1xuICAgICAgaWYgKHRoaXMudGltZV9wYXNzZWQgIT0gbnVsbCkge1xuICAgICAgICB0aW1lX3Bhc3NlZCA9IHRoaXMudGltZV9wYXNzZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgdGltZV9wYXNzZWQgPSBub3cgLSB0aGlzLl90aW1lX3N0YXJ0ZWQ7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGF0dXM6IHRoaXMuc3RhdHVzLFxuICAgICAgICB0aW1lX3Bhc3NlZDogdGltZV9wYXNzZWQsXG4gICAgICAgIHJlYWR5OiB0aGlzLnJlYWR5LFxuICAgICAgICBvcHRpb25zOiB0aGlzLm9wdGlvbnNcbiAgICAgIH07XG4gICAgfTtcblxuICAgIEFmdGVybGFnLnByb3RvdHlwZS5fZmluaXNoID0gZnVuY3Rpb24oc3RhdHVzKSB7XG4gICAgICB2YXIgY2FsbGJhY2ssIGksIGxlbiwgbm93LCByZWYsIHJlc3VsdHM7XG4gICAgICBpZiAodGhpcy5fcHJlcHJvY2VzcyAhPSBudWxsKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9wcmVwcm9jZXNzKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLl9wcm9jZXNzICE9IG51bGwpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLl9wcm9jZXNzKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLl90aW1lb3V0X3Byb2Nlc3MgIT0gbnVsbCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dF9wcm9jZXNzKTtcbiAgICAgIH1cbiAgICAgIHRoaXMucmVhZHkgPSB0cnVlO1xuICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgIHRoaXMudGltZV9wYXNzZWQgPSBub3cgLSB0aGlzLl90aW1lX3N0YXJ0ZWQ7XG4gICAgICByZWYgPSB0aGlzLl9jYWxsYmFja3M7XG4gICAgICByZXN1bHRzID0gW107XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2FsbGJhY2sgPSByZWZbaV07XG4gICAgICAgIHJlc3VsdHMucHVzaChjYWxsYmFjay5mbi5jYWxsKGNhbGxiYWNrLnNlbGYsIHRoaXMuaW5mbygpKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9O1xuXG4gICAgQWZ0ZXJsYWcucHJvdG90eXBlW1wiZG9cIl0gPSBmdW5jdGlvbihzZWxmLCBmbikge1xuICAgICAgaWYgKGZuID09IG51bGwpIHtcbiAgICAgICAgZm4gPSBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKGZuID09IG51bGwpIHtcbiAgICAgICAgZm4gPSBzZWxmO1xuICAgICAgICBzZWxmID0gdGhpcztcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnJlYWR5KSB7XG4gICAgICAgIGZuLmNhbGwoc2VsZiwgdGhpcy5pbmZvKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLnB1c2goe1xuICAgICAgICAgIGZuOiBmbixcbiAgICAgICAgICBzZWxmOiBzZWxmXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIHJldHVybiBBZnRlcmxhZztcblxuICB9KSgpO1xuXG4gIHdpbmRvdy5BZnRlcmxhZyA9IEFmdGVybGFnO1xuXG59KS5jYWxsKHRoaXMpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9