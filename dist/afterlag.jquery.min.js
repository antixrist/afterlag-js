(function(){var t,s;s=function(){function t(){}return t.merge_options=function(t,s){var i,n;n={};for(i in t)n[i]=t[i];for(i in s)n[i]=s[i];return n},t}(),t=function(){function t(t){var s;null==t&&(t={}),this._set_options(t),this._callbacks=[],s=this,this.ready=!1,this.status="processing",this.options.max>0&&(this._timeout_process=setTimeout(function(){return s._finish("timeout")},this.options.max)),this._time_started=(new Date).getTime(),this._last_checked=this._time_started,this._success_iterations=0,this._preprocess=setTimeout(function(){return s._process=setInterval(function(){var t,i;return i=(new Date).getTime(),t=i-s._last_checked-s.options.frequency,s.options.min_delta<t&&t<s.options.max_delta?(s._success_iterations++,s._success_iterations>=s.options.iterations&&s._finish("success")):s._success_iterations=0,s._last_checked=i},s.options.frequency)},this.options.delay)}return t.defaults={delay:100,frequency:30,iterations:3,duration:null,scatter:5,min_delta:null,max_delta:null,max:null},t.prototype._set_options=function(t){return this.options=s.merge_options(this.constructor.defaults,t),null!=this.options.frequency&&(this.options.frequency=parseInt(this.options.frequency)),null!=this.options.iterations&&(this.options.iterations=parseInt(this.options.iterations)),null!=this.options.scatter&&(this.options.scatter=parseInt(this.options.scatter)),null!=this.options.min_delta&&(this.options.min_delta=parseInt(this.options.min_delta)),null!=this.options.max_delta&&(this.options.max_delta=parseInt(this.options.max_delta)),null!=this.options.max&&(this.options.max=parseInt(this.options.max)),null!=this.options.duration&&(this.options.duration=parseInt(this.options.duration),this.options.iterations=Math.ceil(this.options.duration/this.options.frequency)),null==this.options.min_delta&&(this.options.min_delta=-this.options.scatter),null==this.options.max_delta?this.options.max_delta=this.options.scatter:void 0},t.prototype.info=function(){var t,s;return null!=this.time_passed?s=this.time_passed:(t=(new Date).getTime(),s=t-this._time_started),{status:this.status,time_passed:s,ready:this.ready,options:this.options}},t.prototype._finish=function(t){var s,i,n,e,o,a;for(null!=this._preprocess&&clearTimeout(this._preprocess),null!=this._process&&clearInterval(this._process),null!=this._timeout_process&&clearTimeout(this._timeout_process),this.ready=!0,this.status=t,e=(new Date).getTime(),this.time_passed=e-this._time_started,o=this._callbacks,a=[],i=0,n=o.length;n>i;i++)s=o[i],a.push(s.fn.call(s.self,this.info()));return a},t.prototype["do"]=function(t,s){return null==s&&(s=null),null==s&&(s=t,t=this),this.ready?s.call(t,this.info()):this._callbacks.push({fn:s,self:t}),this},t}(),window.Afterlag=t,function(s){var i;return i=null,s.afterlag=function(s){return null==s&&(s={}),i=new t(s)},s.fn.afterlag=function(n,e){var o;return null==n?(n={},o=null!=i?i:s.afterlag()):null==e?"function"==typeof n&&(e=n,n={},o=null!=i?i:s.afterlag()):o=n===!0?s.afterlag():n instanceof t?n:s.afterlag(n),this.each(function(){var t,i;return t=s(this),t.data("afterlag",o),i=this,o["do"](function(s){return null!=e&&e.call(i,s),t.trigger("afterlag",[s])})})}}(jQuery)}).call(this);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFmdGVybGFnLmpxdWVyeS5jb2ZmZWUiLCJhZnRlcmxhZy5qcXVlcnkuanMiXSwibmFtZXMiOlsiQWZ0ZXJsYWciLCJBZnRlcmxhZ0hlbHBlciIsIm1lcmdlX29wdGlvbnMiLCJmaXJzdF9vYmplY3QiLCJzZWNvbmRfb2JqZWN0Iiwia2V5IiwicmVzdWx0X29iamVjdCIsIm9wdGlvbnMiLCJzZWxmIiwidGhpcyIsIl9zZXRfb3B0aW9ucyIsIl9jYWxsYmFja3MiLCJyZWFkeSIsInN0YXR1cyIsIm1heCIsIl90aW1lb3V0X3Byb2Nlc3MiLCJzZXRUaW1lb3V0IiwiX2ZpbmlzaCIsIl90aW1lX3N0YXJ0ZWQiLCJEYXRlIiwiZ2V0VGltZSIsIl9sYXN0X2NoZWNrZWQiLCJfc3VjY2Vzc19pdGVyYXRpb25zIiwiX3ByZXByb2Nlc3MiLCJfcHJvY2VzcyIsInNldEludGVydmFsIiwiZGVsdGEiLCJub3ciLCJmcmVxdWVuY3kiLCJtaW5fZGVsdGEiLCJtYXhfZGVsdGEiLCJpdGVyYXRpb25zIiwiZGVsYXkiLCJkZWZhdWx0cyIsImR1cmF0aW9uIiwic2NhdHRlciIsInByb3RvdHlwZSIsImNvbnN0cnVjdG9yIiwicGFyc2VJbnQiLCJNYXRoIiwiY2VpbCIsImluZm8iLCJ0aW1lX3Bhc3NlZCIsImNhbGxiYWNrIiwiaSIsImxlbiIsInJlZiIsInJlc3VsdHMiLCJjbGVhclRpbWVvdXQiLCJjbGVhckludGVydmFsIiwibGVuZ3RoIiwicHVzaCIsImZuIiwiY2FsbCIsIndpbmRvdyIsIiQiLCJsYXN0X2FmdGVybGFnIiwiYWZ0ZXJsYWciLCJlYWNoIiwiJGVsZW1lbnQiLCJkYXRhIiwidHJpZ2dlciIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FBQSxHQUFBQSxHQUFBQyxDQUFNQSxHQUFBLFdDSUYsUUFBU0EsTUFjVCxNRGpCRkEsR0FBQ0MsY0FBZSxTQUFDQyxFQUFjQyxHQUM3QixHQUFBQyxHQUFBQyxDQUFBQSxLQUNBLEtBQUFELElBQUFGLEdBQ0VHLEVB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QUFjLEVDc0ZFLE9EdEZLLE9BQUFsRCxHQUNMQSxLQUNBa0QsRUFBYyxNQUFBRCxFQUFvQkEsRUFBbUJELEVBQUVFLFlBQzdDLE1BQUFkLEVBQ1csa0JBQWxCcEMsS0FDRG9DLEVBQVdwQyxFQUNYQSxLQUNBa0QsRUFBYyxNQUFBRCxFQUFvQkEsRUFBbUJELEVBQUVFLFlBR3ZEQSxFQURDbEQsS0FBVyxFQUNEZ0QsRUFBRUUsV0FDUGxELFlBQW1CUCxHQUNkTyxFQUVBZ0QsRUFBRUUsU0FBU2xELEdBRTFCRSxLQUFLaUQsS0FBSyxXQUNSLEdBQUFDLEdBQUFuRCxDQzBFRSxPRDFFRm1ELEdBQVdKLEVBQUU5QyxNQUNia0QsRUFBU0MsS0FBSyxXQUFZSCxHQUMxQmpELEVBQU9DLEtBQ1BnRCxFQUFTLE1BQUcsU0FBQ2hCLEdDMkVULE1EMUUyQixPQUFBRSxHQUE3QkEsRUFBU1UsS0FBSzdDLEVBQU1pQyxHQUNwQmtCLEVBQVNFLFFBQVEsWUFBYXBCLFVBOUJoQ3FCLFVDNkdIVCxLQUFLNUMiLCJmaWxlIjoiYWZ0ZXJsYWcuanF1ZXJ5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIz0gaW5jbHVkZSBhZnRlcmxhZy5jb2ZmZWVcblxuZG8gKCQ9alF1ZXJ5KSAtPlxuICBsYXN0X2FmdGVybGFnID0gbnVsbFxuXG4gICQuYWZ0ZXJsYWcgPSAob3B0aW9ucz17fSkgLT5cbiAgICBsYXN0X2FmdGVybGFnID0gbmV3IEFmdGVybGFnKG9wdGlvbnMpXG4gICAgbGFzdF9hZnRlcmxhZ1xuXG4gICQuZm4uYWZ0ZXJsYWcgPSAob3B0aW9ucywgY2FsbGJhY2spIC0+XG4gICAgaWYgbm90IG9wdGlvbnM/XG4gICAgICBvcHRpb25zID0ge31cbiAgICAgIGFmdGVybGFnID0gaWYgbGFzdF9hZnRlcmxhZz8gdGhlbiBsYXN0X2FmdGVybGFnIGVsc2UgJC5hZnRlcmxhZygpXG4gICAgZWxzZSBpZiBub3QgY2FsbGJhY2s/XG4gICAgICBpZiB0eXBlb2Ygb3B0aW9ucyA9PSAnZnVuY3Rpb24nXG4gICAgICAgIGNhbGxiYWNrID0gb3B0aW9uc1xuICAgICAgICBvcHRpb25zID0ge31cbiAgICAgICAgYWZ0ZXJsYWcgPSBpZiBsYXN0X2FmdGVybGFnPyB0aGVuIGxhc3RfYWZ0ZXJsYWcgZWxzZSAkLmFmdGVybGFnKClcbiAgICBlbHNlXG4gICAgICBpZiBvcHRpb25zID09IHRydWVcbiAgICAgICAgYWZ0ZXJsYWcgPSAkLmFmdGVybGFnKClcbiAgICAgIGVsc2UgaWYgb3B0aW9ucyBpbnN0YW5jZW9mIEFmdGVybGFnXG4gICAgICAgIGFmdGVybGFnID0gb3B0aW9uc1xuICAgICAgZWxzZVxuICAgICAgICBhZnRlcmxhZyA9ICQuYWZ0ZXJsYWcob3B0aW9ucylcblxuICAgIHRoaXMuZWFjaCAtPlxuICAgICAgJGVsZW1lbnQgPSAkKEApXG4gICAgICAkZWxlbWVudC5kYXRhICdhZnRlcmxhZycsIGFmdGVybGFnXG4gICAgICBzZWxmID0gQFxuICAgICAgYWZ0ZXJsYWcuZG8gKGluZm8pIC0+XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoc2VsZiwgaW5mbykgaWYgY2FsbGJhY2s/XG4gICAgICAgICRlbGVtZW50LnRyaWdnZXIgJ2FmdGVybGFnJywgW2luZm9dIiwiKGZ1bmN0aW9uKCkge1xuICB2YXIgQWZ0ZXJsYWcsIEFmdGVybGFnSGVscGVyO1xuXG4gIEFmdGVybGFnSGVscGVyID0gKGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIEFmdGVybGFnSGVscGVyKCkge31cblxuICAgIEFmdGVybGFnSGVscGVyLm1lcmdlX29wdGlvbnMgPSBmdW5jdGlvbihmaXJzdF9vYmplY3QsIHNlY29uZF9vYmplY3QpIHtcbiAgICAgIHZhciBrZXksIHJlc3VsdF9vYmplY3Q7XG4gICAgICByZXN1bHRfb2JqZWN0ID0ge307XG4gICAgICBmb3IgKGtleSBpbiBmaXJzdF9vYmplY3QpIHtcbiAgICAgICAgcmVzdWx0X29iamVjdFtrZXldID0gZmlyc3Rfb2JqZWN0W2tleV07XG4gICAgICB9XG4gICAgICBmb3IgKGtleSBpbiBzZWNvbmRfb2JqZWN0KSB7XG4gICAgICAgIHJlc3VsdF9vYmplY3Rba2V5XSA9IHNlY29uZF9vYmplY3Rba2V5XTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHRfb2JqZWN0O1xuICAgIH07XG5cbiAgICByZXR1cm4gQWZ0ZXJsYWdIZWxwZXI7XG5cbiAgfSkoKTtcblxuICBBZnRlcmxhZyA9IChmdW5jdGlvbigpIHtcbiAgICBBZnRlcmxhZy5kZWZhdWx0cyA9IHtcbiAgICAgIGRlbGF5OiAxMDAsXG4gICAgICBmcmVxdWVuY3k6IDMwLFxuICAgICAgaXRlcmF0aW9uczogMyxcbiAgICAgIGR1cmF0aW9uOiBudWxsLFxuICAgICAgc2NhdHRlcjogNSxcbiAgICAgIG1pbl9kZWx0YTogbnVsbCxcbiAgICAgIG1heF9kZWx0YTogbnVsbCxcbiAgICAgIG1heDogbnVsbFxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBBZnRlcmxhZyhvcHRpb25zKSB7XG4gICAgICB2YXIgc2VsZjtcbiAgICAgIGlmIChvcHRpb25zID09IG51bGwpIHtcbiAgICAgICAgb3B0aW9ucyA9IHt9O1xuICAgICAgfVxuICAgICAgdGhpcy5fc2V0X29wdGlvbnMob3B0aW9ucyk7XG4gICAgICB0aGlzLl9jYWxsYmFja3MgPSBbXTtcbiAgICAgIHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgICAgdGhpcy5zdGF0dXMgPSAncHJvY2Vzc2luZyc7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLm1heCA+IDApIHtcbiAgICAgICAgdGhpcy5fdGltZW91dF9wcm9jZXNzID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gc2VsZi5fZmluaXNoKCd0aW1lb3V0Jyk7XG4gICAgICAgIH0sIHRoaXMub3B0aW9ucy5tYXgpO1xuICAgICAgfVxuICAgICAgdGhpcy5fdGltZV9zdGFydGVkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICB0aGlzLl9sYXN0X2NoZWNrZWQgPSB0aGlzLl90aW1lX3N0YXJ0ZWQ7XG4gICAgICB0aGlzLl9zdWNjZXNzX2l0ZXJhdGlvbnMgPSAwO1xuICAgICAgdGhpcy5fcHJlcHJvY2VzcyA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBzZWxmLl9wcm9jZXNzID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGRlbHRhLCBub3c7XG4gICAgICAgICAgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgICAgZGVsdGEgPSBub3cgLSBzZWxmLl9sYXN0X2NoZWNrZWQgLSBzZWxmLm9wdGlvbnMuZnJlcXVlbmN5O1xuICAgICAgICAgIGlmICgoc2VsZi5vcHRpb25zLm1pbl9kZWx0YSA8IGRlbHRhICYmIGRlbHRhIDwgc2VsZi5vcHRpb25zLm1heF9kZWx0YSkpIHtcbiAgICAgICAgICAgIHNlbGYuX3N1Y2Nlc3NfaXRlcmF0aW9ucysrO1xuICAgICAgICAgICAgaWYgKHNlbGYuX3N1Y2Nlc3NfaXRlcmF0aW9ucyA+PSBzZWxmLm9wdGlvbnMuaXRlcmF0aW9ucykge1xuICAgICAgICAgICAgICBzZWxmLl9maW5pc2goJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5fc3VjY2Vzc19pdGVyYXRpb25zID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHNlbGYuX2xhc3RfY2hlY2tlZCA9IG5vdztcbiAgICAgICAgfSwgc2VsZi5vcHRpb25zLmZyZXF1ZW5jeSk7XG4gICAgICB9LCB0aGlzLm9wdGlvbnMuZGVsYXkpO1xuICAgIH1cblxuICAgIEFmdGVybGFnLnByb3RvdHlwZS5fc2V0X29wdGlvbnMgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICB0aGlzLm9wdGlvbnMgPSBBZnRlcmxhZ0hlbHBlci5tZXJnZV9vcHRpb25zKHRoaXMuY29uc3RydWN0b3IuZGVmYXVsdHMsIG9wdGlvbnMpO1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5mcmVxdWVuY3kgIT0gbnVsbCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuZnJlcXVlbmN5ID0gcGFyc2VJbnQodGhpcy5vcHRpb25zLmZyZXF1ZW5jeSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vcHRpb25zLml0ZXJhdGlvbnMgIT0gbnVsbCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuaXRlcmF0aW9ucyA9IHBhcnNlSW50KHRoaXMub3B0aW9ucy5pdGVyYXRpb25zKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2NhdHRlciAhPSBudWxsKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5zY2F0dGVyID0gcGFyc2VJbnQodGhpcy5vcHRpb25zLnNjYXR0ZXIpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5taW5fZGVsdGEgIT0gbnVsbCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMubWluX2RlbHRhID0gcGFyc2VJbnQodGhpcy5vcHRpb25zLm1pbl9kZWx0YSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vcHRpb25zLm1heF9kZWx0YSAhPSBudWxsKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5tYXhfZGVsdGEgPSBwYXJzZUludCh0aGlzLm9wdGlvbnMubWF4X2RlbHRhKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubWF4ICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLm1heCA9IHBhcnNlSW50KHRoaXMub3B0aW9ucy5tYXgpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5kdXJhdGlvbiAhPSBudWxsKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5kdXJhdGlvbiA9IHBhcnNlSW50KHRoaXMub3B0aW9ucy5kdXJhdGlvbik7XG4gICAgICAgIHRoaXMub3B0aW9ucy5pdGVyYXRpb25zID0gTWF0aC5jZWlsKHRoaXMub3B0aW9ucy5kdXJhdGlvbiAvIHRoaXMub3B0aW9ucy5mcmVxdWVuY3kpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5taW5fZGVsdGEgPT0gbnVsbCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMubWluX2RlbHRhID0gLXRoaXMub3B0aW9ucy5zY2F0dGVyO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5tYXhfZGVsdGEgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLm1heF9kZWx0YSA9IHRoaXMub3B0aW9ucy5zY2F0dGVyO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBBZnRlcmxhZy5wcm90b3R5cGUuaW5mbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5vdywgdGltZV9wYXNzZWQ7XG4gICAgICBpZiAodGhpcy50aW1lX3Bhc3NlZCAhPSBudWxsKSB7XG4gICAgICAgIHRpbWVfcGFzc2VkID0gdGhpcy50aW1lX3Bhc3NlZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICB0aW1lX3Bhc3NlZCA9IG5vdyAtIHRoaXMuX3RpbWVfc3RhcnRlZDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1czogdGhpcy5zdGF0dXMsXG4gICAgICAgIHRpbWVfcGFzc2VkOiB0aW1lX3Bhc3NlZCxcbiAgICAgICAgcmVhZHk6IHRoaXMucmVhZHksXG4gICAgICAgIG9wdGlvbnM6IHRoaXMub3B0aW9uc1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgQWZ0ZXJsYWcucHJvdG90eXBlLl9maW5pc2ggPSBmdW5jdGlvbihzdGF0dXMpIHtcbiAgICAgIHZhciBjYWxsYmFjaywgaSwgbGVuLCBub3csIHJlZiwgcmVzdWx0cztcbiAgICAgIGlmICh0aGlzLl9wcmVwcm9jZXNzICE9IG51bGwpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3ByZXByb2Nlc3MpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuX3Byb2Nlc3MgIT0gbnVsbCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuX3Byb2Nlc3MpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuX3RpbWVvdXRfcHJvY2VzcyAhPSBudWxsKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0X3Byb2Nlc3MpO1xuICAgICAgfVxuICAgICAgdGhpcy5yZWFkeSA9IHRydWU7XG4gICAgICB0aGlzLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgdGhpcy50aW1lX3Bhc3NlZCA9IG5vdyAtIHRoaXMuX3RpbWVfc3RhcnRlZDtcbiAgICAgIHJlZiA9IHRoaXMuX2NhbGxiYWNrcztcbiAgICAgIHJlc3VsdHMgPSBbXTtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjYWxsYmFjayA9IHJlZltpXTtcbiAgICAgICAgcmVzdWx0cy5wdXNoKGNhbGxiYWNrLmZuLmNhbGwoY2FsbGJhY2suc2VsZiwgdGhpcy5pbmZvKCkpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH07XG5cbiAgICBBZnRlcmxhZy5wcm90b3R5cGVbXCJkb1wiXSA9IGZ1bmN0aW9uKHNlbGYsIGZuKSB7XG4gICAgICBpZiAoZm4gPT0gbnVsbCkge1xuICAgICAgICBmbiA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAoZm4gPT0gbnVsbCkge1xuICAgICAgICBmbiA9IHNlbGY7XG4gICAgICAgIHNlbGYgPSB0aGlzO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMucmVhZHkpIHtcbiAgICAgICAgZm4uY2FsbChzZWxmLCB0aGlzLmluZm8oKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MucHVzaCh7XG4gICAgICAgICAgZm46IGZuLFxuICAgICAgICAgIHNlbGY6IHNlbGZcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgcmV0dXJuIEFmdGVybGFnO1xuXG4gIH0pKCk7XG5cbiAgd2luZG93LkFmdGVybGFnID0gQWZ0ZXJsYWc7XG5cbiAgKGZ1bmN0aW9uKCQpIHtcbiAgICB2YXIgbGFzdF9hZnRlcmxhZztcbiAgICBsYXN0X2FmdGVybGFnID0gbnVsbDtcbiAgICAkLmFmdGVybGFnID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgaWYgKG9wdGlvbnMgPT0gbnVsbCkge1xuICAgICAgICBvcHRpb25zID0ge307XG4gICAgICB9XG4gICAgICBsYXN0X2FmdGVybGFnID0gbmV3IEFmdGVybGFnKG9wdGlvbnMpO1xuICAgICAgcmV0dXJuIGxhc3RfYWZ0ZXJsYWc7XG4gICAgfTtcbiAgICByZXR1cm4gJC5mbi5hZnRlcmxhZyA9IGZ1bmN0aW9uKG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgYWZ0ZXJsYWc7XG4gICAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XG4gICAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICAgICAgYWZ0ZXJsYWcgPSBsYXN0X2FmdGVybGFnICE9IG51bGwgPyBsYXN0X2FmdGVybGFnIDogJC5hZnRlcmxhZygpO1xuICAgICAgfSBlbHNlIGlmIChjYWxsYmFjayA9PSBudWxsKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGNhbGxiYWNrID0gb3B0aW9ucztcbiAgICAgICAgICBvcHRpb25zID0ge307XG4gICAgICAgICAgYWZ0ZXJsYWcgPSBsYXN0X2FmdGVybGFnICE9IG51bGwgPyBsYXN0X2FmdGVybGFnIDogJC5hZnRlcmxhZygpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdHJ1ZSkge1xuICAgICAgICAgIGFmdGVybGFnID0gJC5hZnRlcmxhZygpO1xuICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMgaW5zdGFuY2VvZiBBZnRlcmxhZykge1xuICAgICAgICAgIGFmdGVybGFnID0gb3B0aW9ucztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhZnRlcmxhZyA9ICQuYWZ0ZXJsYWcob3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciAkZWxlbWVudCwgc2VsZjtcbiAgICAgICAgJGVsZW1lbnQgPSAkKHRoaXMpO1xuICAgICAgICAkZWxlbWVudC5kYXRhKCdhZnRlcmxhZycsIGFmdGVybGFnKTtcbiAgICAgICAgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBhZnRlcmxhZ1tcImRvXCJdKGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgY2FsbGJhY2suY2FsbChzZWxmLCBpbmZvKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuICRlbGVtZW50LnRyaWdnZXIoJ2FmdGVybGFnJywgW2luZm9dKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KShqUXVlcnkpO1xuXG59KS5jYWxsKHRoaXMpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9