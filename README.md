# Afterlag.js
Afterlag.js позволяет отслеживать событие прекращения лагов при загрузке страницы.

Обычно мы запускаем что-то в момент загрузки страницы. Однако, еще какое-то время страница «тормозит». Если в этот момент запустить, например, анимацию появления каких-то блоков на сайте, анимация будет дёргаться и испортит всё впечатление. С помощью Afterlag.js можно запустить эту анимацию в тот момент, когда она сможет воспроизвестиь гладко и без лагов.

Afterlag.js реализована на нативном JavaScript. Также есть плагин для jQuery. Плагин отлично работает из коробки и не требует дополнительных настроек. Изощренный разработчик может покапатьяся в настройках и настроить Afterlag.js под себя.

## Быстрый старт
```
// Нативный JavaScript
afterlag = new Afterlag();
afterlag.do(function() {
  console.log('Лаги прошли, пора начинать!');
});
afterlag.do(function() {
  console.log('Анонимные функции, поднимайтесь!');
});

// jQuery плагин
$.afterlag(function() {
  console.log('Лаги прошли, пора начинать!');
});
$.afterlag(function() {
  console.log('Анонимные функции, поднимайтесь!');
});
```

## Принцип работы
При создании нового объекта `new Afterlag()` запускается интервал, который каждые 30 милесекунд проверяет сколько реально времени прошло с момента его последнего запуска. Если прошло как ожидалось 30 миллесекунд, значит лаги кончились. Чтобы убедиться наверняка, ждём пока время сойдётся 3 раза подряд. Все перечисленные выше значения можно изменить в настройках.

После того как лаги пройдут, будут вызваны все функции переданные через `afterlag.do()`. Если функция будет передана в `afterlag.do()` уже после того, как ончатся лаги, функция будет вызвана немедленно.

При вызове `$.afterlag()` автоматически будет создан новый объект, если прежде уже был вызван `$.afterlag()`, вместо нового объекта возьмётся старый. Функция переданная в `$.afterlag()` будет вызвана после окончания лагов.

## Использование нативного палгина
```
// Создание нового объекта
afterlag = new Afterlag([options])
```
Переменная `afterlag` содержит в себе API и динамически обновляется:
* `afterlag.options` — настройки переданные объекту при его создании  
* `afterlag.ready` — если лаги кончились, то `true` , иначе `false`  
* `afterlag.status` — `"processing"`, если лаги еще не кончились. `"success"`, если лаги действительно кончились. * * * `"timeout"`, если лаги не кончились, но первышено время ожидания окончания лагов.  
* `afterlag.time_passed` — количество милесекунд прошедшие с момента создания объектов до окончания лагов.  
* `afterlag.do()` — метод для добавления колбэков.  

```
// Добавление колбэка
afterlag.do(function(info) {})
```
Переданная функция будет вызвана по завершению лагов. Если лаги уже кончились, функция будет вызвана сразу же. Переменная `info` является объектом и несёт в себе информацию об объекте `afterlag` в момент вызова переданной функции:  
* `info.status` — `"success"`, если лаги действительно кончились. `"timeout"`, если лаги не кончились, но первышено время ожидания окончания лагов.  
* `info.time_passed` — количество милесекунд прошедшие с момента создания объектов до окончания лагов.  
* `info.ready` — если лаги кончились, то `true` , иначе `false`  
* `info.options` — настройки переданные объекту при его создании

```
// Добавление колбэка с указанием this
afterlag.do(object, function(info) {})
```
`object` будет доступен внутри переданной функции как `this`

